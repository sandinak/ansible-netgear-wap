# NETGEAR WAX210 Technical Reference

This document contains technical details for the WAX210 LuCI interface, useful for AI assistants and developers extending the collection.

## Firmware Version
- **Tested**: V1.1.0.34
- **Firmware File**: WAX210-V1.1.0.34.bin

## Authentication

### Password Hashing
```python
import hashlib
hashed = hashlib.sha512((password + "\n").encode()).hexdigest()
```

### Login Request
```
POST /cgi-bin/luci
Content-Type: application/x-www-form-urlencoded
Cookie: is_login=1

username=admin&password=<sha512_hash>&agree=1&account=admin
```

### Session Management
- **Session Token**: `stok` in URL path (e.g., `/cgi-bin/luci/;stok=abc123/admin/...`)
- **Cookie**: `sysauth=<session_id>`
- Extract stok from redirect URL after login

## API Endpoints

| Function | Method | URL |
|----------|--------|-----|
| Login | POST | `/cgi-bin/luci` |
| Wireless Main | GET | `/admin/network/wireless_device` |
| Interface Status | GET | `/admin/network/iface_status2/<networks>` |
| SSID Config Popup | GET/POST | `/admin/network/wifi_Encryption_P2P` |
| Channel Config Popup | GET/POST | `/admin/network/wifi_Channel` |
| UCI Changes | GET | `/admin/system/ajax_get_uci_wifi_network_changes` |
| Save & Apply | POST | `/admin/uci/saveapply` |

## Radio Mapping

| Device | Band | Description |
|--------|------|-------------|
| `wifi0` | 2.4GHz | First radio |
| `wifi1` | 5GHz | Second radio |

## SSID Interface Naming

SSIDs are named as `wifiX_ssid_N` where:
- `X` = radio number (0 or 1)
- `N` = SSID slot number (1-8)

Example: `wifi0_ssid_1` = First SSID on 2.4GHz radio

## Form Field Names (UCI Format)

### SSID Configuration
| Setting | Field Name |
|---------|------------|
| SSID Name | `cbid.wireless.wifiX_ssid_N.ssid` |
| VLAN | `cbid.wireless.wifiX_ssid_N.network` |
| Encryption | `cbid.wireless.wifiX_ssid_N.encryption` |
| Passphrase | `cbid.wireless.wifiX_ssid_N.key` |
| Disabled | `cbid.wireless.wifiX_ssid_N.disabled` |
| Hidden | `cbid.wireless.wifiX_ssid_N.hidden` |
| Isolation | `cbid.wireless.wifiX_ssid_N.isolate` |

### Radio Configuration
| Setting | Field Name |
|---------|------------|
| Channel | `cbid.wireless.wifiX.channel` |
| HT Mode | `cbid.wireless.wifiX.htmode` |
| TX Power | `cbid.wireless.wifiX.txpower` |

### System Configuration
| Setting | Field Name |
|---------|------------|
| AP Name | `cbid.system.system.SystemName` |
| Mgmt Interface Disabled | `cbid.wireless.wifiX_mgmt.disabled` |

## Passphrase Encryption

Passphrases are AES-256-ECB encrypted with a static key:

```python
KEY = bytes([
    0x4e, 0x54, 0x47, 0x52, 0x57, 0x41, 0x50, 0x31,
    0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39,
    0x4e, 0x54, 0x47, 0x52, 0x57, 0x41, 0x50, 0x31,
    0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39
])  # "NTGRWAP123456789NTGRWAP123456789"
```

### Encryption
```python
from Crypto.Cipher import AES
cipher = AES.new(KEY, AES.MODE_ECB)
padded = passphrase.ljust(64, '\x00').encode()
encrypted = cipher.encrypt(padded).hex()
```

### Decryption
```python
decrypted = cipher.decrypt(bytes.fromhex(encrypted))
passphrase = decrypted.rstrip(b'\x00').decode()
```

## SSID Config Popup Form

### URL Pattern
```
/admin/network/wifi_Encryption_P2P?ssid_name=<name>&wifi0_ssid=<slot>&wifi1_ssid=<slot>
```

### Form Submission
```python
form_data = {
    'ssid_name': 'MySSID',
    'wifi0_ssid': '1',
    'wifi1_ssid': '1',
    'wifi0_vlan': 'vlan121',
    'wifi1_vlan': 'vlan121',
    'wifi0_encryption': 'sae-mixed',
    'wifi1_encryption': 'sae-mixed',
    'wifi0_key': '<aes_encrypted_passphrase>',
    'wifi1_key': '<aes_encrypted_passphrase>',
    'wifi0_disabled': '0',  # 0=enabled, 1=disabled
    'wifi1_disabled': '0',
    'form_submit': '1',
    'val_csrf': '<csrf_token>',
}
```

## Channel Config Popup Form

### URL
```
/admin/network/wifi_Channel
```

### Form Fields
| Field | Values |
|-------|--------|
| `cbid.wireless.wifi0.channel` | auto, 1-11 |
| `cbid.wireless.wifi1.channel` | auto, 36, 40, 44, 48, 149, 153, 157, 161, 165 |

## Management Interface

The management interface SSID is auto-generated:
- Name format: `EnMGMT<MAC_SUFFIX>` (e.g., `EnMGMT9BA434`)
- Interface names: `wifi0_mgmt`, `wifi1_mgmt`
- Disable by setting `cbid.wireless.wifiX_mgmt.disabled=1`

## Valid Channel Values

### 2.4GHz (wifi0)
- `auto`, `1`, `2`, `3`, `4`, `5`, `6`, `7`, `8`, `9`, `10`, `11`

### 5GHz (wifi1)
- `auto`, `36`, `40`, `44`, `48`, `149`, `153`, `157`, `161`, `165`
- DFS channels may be available depending on region

